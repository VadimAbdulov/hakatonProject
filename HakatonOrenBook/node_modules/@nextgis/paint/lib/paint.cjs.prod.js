"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@nextgis/expression"),n=require("@nextgis/properties-filter");function i(n){return i=>{const e=i.properties;return!!e&&t.evaluate(n,e)}}const e=["iconSize","iconAnchor"];function r(n){let r=!1;const o={};for(const a in n)if(-1===e.indexOf(a)){const e=a,s=n[e];t.isExpression(s)&&(r=!0,o[e]=i(s))}if(r)return t=>{const i={};for(const n in o)i[n]=o[n](t);return{...n,...i}}}function o(t){return!!Array.isArray(t)}function a(t){return"[object Object]"===Object.prototype.toString.call(t)}function s(t){return"function"==typeof t}function c(t){let i={};const e=[];for(const n of t)n&&(Array.isArray(n)?e.push(n):i=n);return t=>{const r=e.find((i=>n.featureFilter(t,i[0])));return r?{...i,...r[1]}:i}}function p({paint:t,defaultPaint:n}){var i;let e={...n};return e={...e,...t},e.fill=null==(i=e.fill)||i,e.stroke=void 0!==e.stroke?e.stroke:!e.fill||!(!e.strokeColor&&!e.strokeOpacity),e}function f({paint:t,defaultPaint:n,getPaintFunctions:i}){if(!t)throw new Error("paint is empty");let e={...n};if(s(t)){const e=e=>{const r=f({paint:t(e),defaultPaint:n,getPaintFunctions:i});return r.type=t.type,r};return e.type=t.type,e}if(o(t))return e=>f({paint:c(t)(e),defaultPaint:n,getPaintFunctions:i});if("get-paint"===t.type){const r=function(t,n){if("function"==typeof t.from)return t.from(t.options);if("string"==typeof t.from&&n){const i=n[t.from];if(i)return i(t.options)}}(t,i);r&&(e=f({paint:r,defaultPaint:n,getPaintFunctions:i}))}else{if("icon"===t.type)return t;e=function({paint:t,defaultPaint:n}){const i=r(t);if(i){const e=t=>f({paint:i(t),defaultPaint:n});return e.paint=p({paint:t,defaultPaint:n}),e}return p({paint:t,defaultPaint:n})}({paint:t,defaultPaint:n})}return s(e)||("color"in e&&(e.strokeColor||(e.strokeColor=e.color),e.fillColor||(e.fillColor=e.color)),"opacity"in e&&(void 0===e.strokeOpacity&&(e.strokeOpacity=e.opacity),void 0===e.fillOpacity&&(e.fillOpacity=e.opacity))),e}exports.createExpressionCallback=r,exports.isBasePaint=function(t){return!!a(t)&&("get-paint"!==t.type&&"icon"!==t.type)},exports.isIcon=function(t){return"icon"===t.type||"html"in t},exports.isPaint=a,exports.isPaintCallback=s,exports.isPropertiesPaint=o,exports.preparePaint=f;
//# sourceMappingURL=paint.cjs.prod.js.map
